<div class="container">
  <div class="shop-container">
    <%= render_breadcrumbs builder: ::CustomBreadcrumbsBuilder %>
    <h2>お店の詳細</h2>
    <div class="main-contents">
      <h2><%= @shop.name%></h2>
      <%= image_tag @shop.shop_image, class: "shop-image-size" %>
      <div class="shop-details">
        <p><strong>住所:</strong> <%= @shop.address %></p>
        <p><strong>オススメの商品:</strong> <%= @shop.product_name %></p>
        <p><strong>味の系統:</strong> <%= @shop.taste %></p>
        <p><strong>お店のPR:</strong> <%= @shop.description %></p>
        <p><strong>予算:</strong> <%= @shop.price %>円~</p>
        <% if @shop.shop_url.present? %>
          <p><strong>お店のURL:</strong> 
            <%= link_to @shop.shop_url, @shop.shop_url, target: "_blank", rel: "noopener noreferrer" %>
          </p>
        <% else %>
          <p><strong>お店のURL:</strong> URLは登録されていません</p>
        <% end %>
        <p><strong>平均スコア:</strong> 
          <% if @average_score.present? %>
            <%= @average_score.round(2) %>
          <% else %>
            <%= "まだレビューがありません" %>
          <% end %>
        </p>
      </div> 
      <div class="store-rating">
        <p><%= link_to "口コミ (#{@shop.reviews.count})件", shop_reviews_path(@shop) %></p>
        <% if @shop.liked?(current_user) %>
          <%= link_to shop_like_path(@shop.id), method: :delete, data: { turbo_method: :delete } do %>
            <i class="fas fa-heart unlike-btn"></i><span class="like-count"><%= @shop.likes.count %></span>
          <% end %>
        <% else %>
          <%= link_to shop_like_path(@shop.id), method: :post, data: { turbo_method: :post } do %>
            <i class="far fa-heart like-btn" ></i><span class="like-count"><%= @shop.likes.count %></span>
          <% end %>
        <% end %>
      </div>
      <div class="shop-edit">
        <% if user_signed_in? && @shop.user_id == current_user.id %>
          <p><%= link_to "編集",[:edit,@shop], class: "btn btn-primary custom-button" %></p>
          <p><%= link_to "削除", @shop, method: :delete,
              data: { turbo_method: :delete, turbo_confirm: "本当に削除してよろしいですか？" }, class: "btn btn-danger custom-button" %>
          </p>
        <% end %>
      </div>
    </div>
  </div>
</div>
